CREATE TABLE IF NOT EXISTS `lvl_exp2` (
  `lvl` tinyint(3) unsigned NOT NULL,
  `exp` int(10) unsigned NOT NULL
) ENGINE=MyISAM DEFAULT CHARSET=utf8 ROW_FORMAT=FIXED;

# Dumping data for table data.lvl_exp2: 79 rows
/*!40000 ALTER TABLE `lvl_exp2` DISABLE KEYS */;
INSERT INTO `lvl_exp2` (`lvl`, `exp`) VALUES
	(1, 300),
	(2, 800),
	(3, 1500),
	(4, 2500),
	(5, 3800),
	(6, 5100),
	(7, 6600),
	(8, 8400),
	(9, 10300),
	(10, 12500),
	(11, 14900),
	(12, 17500),
	(13, 20300),
	(14, 23300),
	(15, 26600),
	(16, 30100),
	(17, 33800),
	(18, 37800),
	(19, 42000),
	(20, 46600),
	(21, 51400),
	(22, 56600),
	(23, 62000),
	(24, 67900),
	(25, 74200),
	(26, 81000),
	(27, 88300),
	(28, 96200),
	(29, 104800),
	(30, 123800),
	(31, 143800),
	(32, 164800),
	(33, 185800),
	(34, 203800),
	(35, 222800),
	(36, 249800),
	(37, 281800),
	(38, 317800),
	(39, 354800),
	(40, 450800),
	(41, 646800),
	(42, 947800),
	(43, 1358800),
	(44, 1883800),
	(45, 2527800),
	(46, 3295800),
	(47, 4191800),
	(48, 5220800),
	(49, 6192800),
	(50, 7304800),
	(51, 8564800),
	(52, 9980800),
	(53, 11559800),
	(54, 13309800),
	(55, 15238800),
	(56, 17354800),
	(57, 19664800),
	(58, 22176800),
	(59, 24509800),
	(60, 27469800),
	(61, 31109800),
	(62, 35482800),
	(63, 40642800),
	(64, 46097800),
	(65, 52364800),
	(66, 59491800),
	(67, 67527800),
	(68, 77709800),
	(69, 89784800),
	(70, 105709800),
	(71, 126009800),
	(72, 151209800),
	(73, 181834800),
	(74, 216265800),
	(75, 255533800),
	(76, 299923800),
	(77, 349720800),
	(78, 413744800),
	(79, 493419800);
/*!40000 ALTER TABLE `lvl_exp2` ENABLE KEYS */;

UPDATE `fighter` `fighter`,
(SELECT `id`, `lexp2`.`exp` `exp_low`,`lexp`.`exp` - `lexp2`.`exp` `exp_range` FROM ((`fighter` `fgt` LEFT JOIN `lvl_exp2` `lexp` ON `fgt`.`level` = `lexp`.`lvl`) LEFT JOIN `lvl_exp2` `lexp2` ON `fgt`.`level` = `lexp2`.`lvl` + 1) WHERE `fgt`.`level` < 80 AND `fgt`.`level` > 1) `a`,
(SELECT `id`, (`experience` - `lexp2`.`exp`) `exp_norm`, (`lexp`.`exp` - `lexp2`.`exp`) `exp_range` FROM ((`fighter` `fgt` LEFT JOIN `data`.`lvl_exp` `lexp` ON `fgt`.`level` = `lexp`.`lvl`) LEFT JOIN `data`.`lvl_exp` `lexp2` ON `fgt`.`level` = `lexp2`.`lvl` + 1) WHERE `fgt`.`level` < 80 AND `fgt`.`level` > 1) `b`
SET `fighter`.`experience` = floor((`a`.`exp_low` + `a`.`exp_range` * `b`.`exp_norm` / `b`.`exp_range`) / 50) * 50
WHERE `a`.`id` = `b`.`id` AND `fighter`.`id` = `a`.`id`;

DROP TABLE `lvl_exp2`;
